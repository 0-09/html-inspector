/*!
 * HTML Inspector - v0.1.0
 *
 * Copyright (c) 2013 Philip Walton <http://philipwalton.com>
 * Released under the MIT license
 *
 * Date: 2013-05-26
 */
!function(a,b,c){function d(a){return[].slice.call(a)}function e(a){var b=[];return a=a.sort(),a.forEach(function(c,d){c!==a[d-1]&&b.push(c)}),b}function f(){this._events={}}f.prototype.on=function(a,c){this._events[a]||(this._events[a]=b.Callbacks()),this._events[a].add(c)},f.prototype.off=function(a,b){this._events[a]&&this._events[a].remove(b)},f.prototype.trigger=function(a,b,c){events[a]&&events[a].fireWith(b,c)};var g=function(){function a(a){a="all"==a?Object.keys(h.rules):a,a.forEach(function(a){h.rules[a]&&h.rules[a].call(h)})}function e(){h.removeEvents(),g=[]}function f(a){h.trigger("beforeInspect"),b(a).find("*").each(function(){var a=this;h.trigger("element",[a]),a.id&&h.trigger("id",[a.id,a]),d(a.classList).forEach(function(b){h.trigger("class",[b,a])})}),h.trigger("afterInspect")}var g=[],h={config:{rules:"all",domRoot:c,complete:function(a){a.forEach(function(a){console.warn(a.message,a.context)})}},rules:{},extensions:{},addRule:function(a,b){h.rules[a]=b},addExtension:function(a,b){h.extensions[a]=b},addError:function(a,b,c){g.push({rule:a,message:b,context:c})},inspect:function(c){b.isPlainObject(c)||(c={domRoot:c}),c=b.extend({},h.config,c),a(c.rules),f(c.domRoot),c.complete(g),e()}};return b.extend(h,observable)}();g.addExtension("css",function(){function a(b){return b.reduce(function(b,c){var e;return c.cssRules?b.concat(a(d(c.cssRules))):c.selectorText?(e=c.selectorText.match(h)||[],b.concat(e.map(function(a){return a.slice(1)}))):b},[])}function f(b){return b.reduce(function(b,c){return b.concat(a(d(c.cssRules)))},[])}function g(){return d(c.styleSheets).filter(function(a){return b(a.ownerNode).is(i.styleSheets)})}var h=/\.[a-z0-9_\-]+/gi,i={getClassSelectors:function(){return e(f(g()))},styleSheets:'link[rel="stylesheet"], style'};return i}()),g.addRule("nonsemantic-elements",function(){this.on("element",function(a){var b="DIV"==a.nodeName||"SPAN"==a.nodeName,c=0===a.attributes.length;b&&c&&this.addError("nonsemantic-elements","Do not use <div> or <span> elements without any attributes",a)})}),g.addRule("unused-classes",function(){var a=/^js\-|^supports\-|^language\-|^lang\-/,b=this.extensions.css.getClassSelectors();this.on("class",function(c,d){a.test(c)||-1!=b.indexOf(c)||this.addError("unused-classes","The class '"+c+"' is used in the HTML but not found in any stylesheet",d)})}),window.HTMLInspector=g}(this,jQuery,document);