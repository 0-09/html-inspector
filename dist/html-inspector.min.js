/*!
 * HTML Inspector - v0.1.0
 *
 * Copyright (c) 2013 Philip Walton <http://philipwalton.com>
 * Released under the MIT license
 *
 * Date: 2013-05-25
 */
!function(a,b,c){function d(a){return[].slice.call(a)}function e(a){var b=[];return a=a.sort(),a.forEach(function(c,d){c!==a[d-1]&&b.push(c)}),b}var f=function(){function a(a){f.resetEvents(),a="all"==a?Object.keys(n):a,a.forEach(function(a){n[a]&&n[a].init.call(f)})}function e(){f.trigger("beforeInspect",f)}function g(){f.trigger("afterInspect",f)}function h(a){b(a).find("*").each(function(){var a=this;i(a),a.id&&k(a.id,a),d(a.classList).forEach(function(b){j(b,a)})})}function i(a){f.trigger("element",f,[a])}function j(a,b){f.trigger("class",f,[a,b])}function k(a){f.trigger("id",f,[a,name])}function l(a){a.forEach(function(a){console.warn(a.message,a.context)})}var m,n={},o=[];return{config:{rules:"all",domRoot:c,timeout:1,styleSheets:b('link[rel="stylesheet"], style')},addRule:function(a){n[a.id]=a},report:function(a,b,c){o.push({rule:a,message:b,context:c})},inspect:function(c){b.isPlainObject(c)||(c={domRoot:c}),c=b.extend({},f.config,c),o=[],m=null,setTimeout(function(){a(c.rules),e(),h(c.domRoot),g();var b="function"==typeof m?m:l;b.call(f,o)},f.config.timeout)},done:function(a){m=a}}}(),g=function(){var a={};return{on:function(c,d){a[c]||(a[c]=b.Callbacks()),a[c].add(d)},off:function(b,c){a[b]&&a[b].remove(c)},trigger:function(b,c,d){a[b]&&a[b].fireWith(c,d)},resetEvents:function(){a={}}}}(),h=function(a){function b(a){return a.reduce(function(a,c){var e;return c.cssRules?a.concat(b(d(c.cssRules))):c.selectorText?(e=c.selectorText.match(h)||[],a.concat(e.map(function(a){return a.slice(1)}))):a},[])}function f(a){return a.reduce(function(a,c){return c.href?b(d(c.cssRules)):a},[])}function g(){return d(c.styleSheets).filter(function(b){return a.styleSheets.is(b.ownerNode)})}var h=/\.[a-z0-9_\-]+/gi;return{sheetSheets:{getClassSelectors:function(){return e(f(g()))},getSelectors:function(){return[]}}}}(f.config);window.HTMLInspector=b.extend(f,g,h)}(this,jQuery,document),HTMLInspector.addRule({id:"unsemantic-elements",type:"error",init:function(){this.on("element",function(a){var b="DIV"==a.nodeName||"SPAN"==a.nodeName,c=0===a.attributes.length;b&&c&&this.report("unsemantic-elements","Do not use <div> or <span> elements without any attributes",a)})}}),HTMLInspector.addRule({id:"unused-classes",type:"error",init:function(){var a=/^js\-|^supports\-|^language\-|^lang\-/,b=this.sheetSheets.getClassSelectors();this.on("class",function(c,d){a.test(c)||-1!=b.indexOf(c)||this.report("unused-classes","The class '"+c+"' is used in the HTML but not found in any stylesheet",d)})}});