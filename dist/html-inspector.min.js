/*!
 * HTML Inspector - v0.1.0
 *
 * Copyright (c) 2013 Philip Walton <http://philipwalton.com>
 * Released under the MIT license
 *
 * Date: 2013-06-01
 */
!function(a,b,c){function d(a){return a?[].slice.call(a):[]}function e(a){return"[object RegExp]"==Object.prototype.toString.call(a)}function f(a){var b=[];return a=a.sort(),a.forEach(function(c,d){c!==a[d-1]&&b.push(c)}),b}function g(a,b){return b.some(function(b){return e(b)?b.test(a):a===b})}function h(){this._events={}}function i(){this._errors=[]}h.prototype.on=function(a,c){this._events[a]||(this._events[a]=b.Callbacks()),this._events[a].add(c)},h.prototype.off=function(a,b){this._events[a]&&this._events[a].remove(b)},h.prototype.trigger=function(a,b,c){this._events[a]&&this._events[a].fireWith(b,c)},i.prototype.addError=function(a,b,c){this._errors.push({rule:a,message:b,context:c})},i.prototype.getErrors=function(){return this._errors};var j=function(){function a(a,b,c){a="all"==a?Object.keys(f.rules):a,a.forEach(function(a){f.rules[a]&&f.rules[a].call(f,b,c)})}function c(a,c){var e=b(a),g=e.add(e.find("*"));c.trigger("beforeInspect",f.config.domRoot),g.each(function(){var a=this;c.trigger("element",a,[a.nodeName.toLowerCase(),a]),a.id&&c.trigger("id",a,[a.id,a]),d(a.classList).forEach(function(b){c.trigger("class",a,[b,a])}),d(a.attributes).forEach(function(b){c.trigger("attribute",a,[b.name,b.value])})}),c.trigger("afterInspect",f.config.domRoot)}function e(a){return a&&("string"==typeof a||1==a.nodeType||a instanceof b?a={domRoot:a}:Array.isArray(a)?a={rules:a}:"function"==typeof a&&(a={complete:a})),b.extend({},f.config,a)}var f={config:{rules:"all",domRoot:"html",complete:function(a){a.forEach(function(a){console.warn(a.message,a.context)})}},rules:{},modules:{},addRule:function(a,b){f.rules[a]=b},addModule:function(a,b){f.modules[a]=b},inspect:function(b){var d=new h,f=new i;b=e(b),a(b.rules,d,f),c(b.domRoot,d),b.complete(f.getErrors())}};return f}();j.addModule("bem",function(){var a=/^[A-Z][a-zA-Z]*\-\-[a-zA-Z]+$/,b=/^[A-Z][a-zA-Z]*\-[a-zA-Z]+$/,c=/^([A-Z][a-zA-Z]*)\-\-?[a-zA-Z]+$/;return{getBlockName:function(a){return c.test(a)&&RegExp.$1},isBlockModifier:function(b){return a.test(b)},isBlockElement:function(a){return b.test(a)}}}()),j.addModule("css",function(){function a(b){return b.reduce(function(b,c){var e;return c.cssRules?b.concat(a(d(c.cssRules))):c.selectorText?(e=c.selectorText.match(h)||[],b.concat(e.map(function(a){return a.slice(1)}))):b},[])}function e(b){return b.reduce(function(b,c){return b.concat(a(d(c.cssRules)))},[])}function g(){return d(c.styleSheets).filter(function(a){return b(a.ownerNode).is(i.styleSheets)})}var h=/\.[a-z0-9_\-]+/gi,i={getClassSelectors:function(){return f(e(g()))},styleSheets:'link[rel="stylesheet"], style',whitelist:/^js\-|^supports\-|^language\-|^lang\-/};return i}()),j.addModule("validation",function(){function a(a){return d[a].attributes.replace(/\*/g,"").split(/\s*;\s*/)}function b(a){return g(a,e)}function c(a){return g(a,k.attributeWhitelist)}var d={a:{children:"transparent*",attributes:"globals; href; target; download; rel; hreflang; type"},abbr:{children:"phrasing",attributes:"globals"},address:{children:"flow*",attributes:"globals"},area:{children:"empty",attributes:"globals; alt; coords; shape; href; target; download; rel; hreflang; type"},article:{children:"flow",attributes:"globals"},aside:{children:"flow",attributes:"globals"},audio:{children:"source*; transparent*",attributes:"globals; src; crossorigin; preload; autoplay; mediagroup; loop; muted; controls"},b:{children:"phrasing",attributes:"globals"},base:{children:"empty",attributes:"globals; href; target"},bdi:{children:"phrasing",attributes:"globals"},bdo:{children:"phrasing",attributes:"globals"},blockquote:{children:"flow",attributes:"globals; cite"},body:{children:"flow",attributes:"globals; onafterprint; onbeforeprint; onbeforeunload; onfullscreenchange; onfullscreenerror; onhashchange; onmessage; onoffline; ononline; onpagehide; onpageshow; onpopstate; onresize; onstorage; onunload"},br:{children:"empty",attributes:"globals"},button:{children:"phrasing*",attributes:"globals; autofocus; disabled; form; formaction; formenctype; formmethod; formnovalidate; formtarget; name; type; value"},canvas:{children:"transparent",attributes:"globals; width; height"},caption:{children:"flow*",attributes:"globals"},cite:{children:"phrasing",attributes:"globals"},code:{children:"phrasing",attributes:"globals"},col:{children:"empty",attributes:"globals; span"},colgroup:{children:"col",attributes:"globals; span"},menuitem:{children:"empty",attributes:"globals; type; label; icon; disabled; checked; radiogroup; command"},data:{children:"phrasing",attributes:"globals; value"},datalist:{children:"phrasing; option",attributes:"globals"},dd:{children:"flow",attributes:"globals"},del:{children:"transparent",attributes:"globals; cite; datetime"},details:{children:"summary*; flow",attributes:"globals; open"},dfn:{children:"phrasing*",attributes:"globals"},dialog:{children:"flow",attributes:"globals; open"},div:{children:"flow",attributes:"globals"},dl:{children:"dt*; dd*",attributes:"globals"},dt:{children:"flow*",attributes:"globals"},em:{children:"phrasing",attributes:"globals"},embed:{children:"empty",attributes:"globals; src; type; width; height; any*"},fieldset:{children:"legend*; flow",attributes:"globals; disabled; form; name"},figcaption:{children:"flow",attributes:"globals"},figure:{children:"figcaption*; flow",attributes:"globals"},footer:{children:"flow*",attributes:"globals"},form:{children:"flow*",attributes:"globals; accept-charset; action; autocomplete; enctype; method; name; novalidate; target"},h1:{children:"phrasing",attributes:"globals"},h2:{children:"phrasing",attributes:"globals"},h3:{children:"phrasing",attributes:"globals"},h4:{children:"phrasing",attributes:"globals"},h5:{children:"phrasing",attributes:"globals"},h6:{children:"phrasing",attributes:"globals"},head:{children:"metadata content*",attributes:"globals"},header:{children:"flow*",attributes:"globals"},hr:{children:"empty",attributes:"globals"},html:{children:"head*; body*",attributes:"globals; manifest"},i:{children:"phrasing",attributes:"globals"},iframe:{children:"text*",attributes:"globals; src; srcdoc; name; sandbox; seamless; allowfullscreen; width; height"},img:{children:"empty",attributes:"globals; alt; src; crossorigin; usemap; ismap; width; height"},input:{children:"empty",attributes:"globals; accept; alt; autocomplete; autofocus; checked; dirname; disabled; form; formaction; formenctype; formmethod; formnovalidate; formtarget; height; list; max; maxlength; min; multiple; name; pattern; placeholder; readonly; required; size; src; step; type; value; width"},ins:{children:"transparent",attributes:"globals; cite; datetime"},kbd:{children:"phrasing",attributes:"globals"},keygen:{children:"empty",attributes:"globals; autofocus; challenge; disabled; form; keytype; name"},label:{children:"phrasing*",attributes:"globals; form; for"},legend:{children:"phrasing",attributes:"globals"},li:{children:"flow",attributes:"globals; value*"},link:{children:"empty",attributes:"globals; href; crossorigin; rel; media; hreflang; type; sizes"},main:{children:"flow*",attributes:"globals"},map:{children:"transparent; area*",attributes:"globals; name"},mark:{children:"phrasing",attributes:"globals"},menu:{children:"li*; flow*; menuitem*; hr*; menu*",attributes:"globals; type; label"},meta:{children:"empty",attributes:"globals; name; http-equiv; content; charset"},meter:{children:"phrasing*",attributes:"globals; value; min; max; low; high; optimum"},nav:{children:"flow",attributes:"globals"},noscript:{children:"varies*",attributes:"globals"},object:{children:"param*; transparent",attributes:"globals; data; type; typemustmatch; name; usemap; form; width; height"},ol:{children:"li",attributes:"globals; reversed; start type"},optgroup:{children:"option",attributes:"globals; disabled; label"},option:{children:"text*",attributes:"globals; disabled; label; selected; value"},output:{children:"phrasing",attributes:"globals; for; form; name"},p:{children:"phrasing",attributes:"globals"},param:{children:"empty",attributes:"globals; name; value"},pre:{children:"phrasing",attributes:"globals"},progress:{children:"phrasing*",attributes:"globals; value; max"},q:{children:"phrasing",attributes:"globals; cite"},rp:{children:"phrasing",attributes:"globals"},rt:{children:"phrasing",attributes:"globals"},ruby:{children:"phrasing; rt; rp*",attributes:"globals"},s:{children:"phrasing",attributes:"globals"},samp:{children:"phrasing",attributes:"globals"},script:{children:"script, data, or script documentation*",attributes:"globals; src; type; charset; async; defer; crossorigin"},section:{children:"flow",attributes:"globals"},select:{children:"option, optgroup",attributes:"globals; autofocus; disabled; form; multiple; name; required; size"},small:{children:"phrasing",attributes:"globals"},source:{children:"empty",attributes:"globals; src; type; media"},span:{children:"phrasing",attributes:"globals"},strong:{children:"phrasing",attributes:"globals"},style:{children:"varies*",attributes:"globals; media; type; scoped"},sub:{children:"phrasing",attributes:"globals"},summary:{children:"phrasing",attributes:"globals"},sup:{children:"phrasing",attributes:"globals"},table:{children:"caption*; colgroup*; thead*; tbody*; tfoot*; tr*",attributes:"globals; border"},tbody:{children:"tr",attributes:"globals"},td:{children:"flow",attributes:"globals; colspan; rowspan; headers"},textarea:{children:"text",attributes:"globals; autofocus; cols; dirname; disabled; form; maxlength; name; placeholder; readonly; required; rows; wrap"},tfoot:{children:"tr",attributes:"globals"},th:{children:"flow*",attributes:"globals; colspan; rowspan; headers; scope; abbr"},thead:{children:"tr",attributes:"globals"},time:{children:"phrasing",attributes:"globals; datetime"},title:{children:"text*",attributes:"globals"},tr:{children:"th*; td",attributes:"globals"},track:{children:"empty",attributes:"globals; default; kind; label; src; srclang"},u:{children:"phrasing",attributes:"globals"},ul:{children:"li",attributes:"globals"},"var":{children:"phrasing",attributes:"globals"},video:{children:"source*; transparent*",attributes:"globals; src; crossorigin; poster; preload; autoplay; mediagroup; loop; muted; controls; width; height"},wbr:{children:"empty",attributes:"globals"}},e=["accesskey","class","contenteditable","contextmenu","dir","draggable","dropzone","hidden","id","inert","itemid","itemprop","itemref","itemscope","itemtype","lang","spellcheck","style","tabindex","title","translate","role",/aria-[a-z\-]+/,/data-[a-z\-]+/,/on[a-z\-]+/],f=["applet","acronym","bgsound","dir","frame","frameset","noframes","hgroup","isindex","listing","nextid","noembed","plaintext","rb","strike","xmp","basefont","big","blink","center","font","marquee","multicol","nobr","spacer","tt"],h=[{attribute:"charset",elements:"a"},{attribute:"charset",elements:"link"},{attribute:"coords",elements:"a"},{attribute:"shape",elements:"a"},{attribute:"methods",elements:"a"},{attribute:"methods",elements:"link"},{attribute:"name",elements:"a"},{attribute:"name",elements:"embed"},{attribute:"name",elements:"img"},{attribute:"name",elements:"option"},{attribute:"rev",elements:"a"},{attribute:"rev",elements:"link"},{attribute:"urn",elements:"a"},{attribute:"urn",elements:"link"},{attribute:"accept",elements:"form"},{attribute:"nohref",elements:"area"},{attribute:"profile",elements:"head"},{attribute:"version",elements:"html"},{attribute:"ismap",elements:"input"},{attribute:"usemap",elements:"input"},{attribute:"longdesc",elements:"iframe"},{attribute:"longdesc",elements:"img"},{attribute:"lowsrc",elements:"img"},{attribute:"target",elements:"link"},{attribute:"scheme",elements:"meta"},{attribute:"archive",elements:"object"},{attribute:"classid",elements:"object"},{attribute:"code",elements:"object"},{attribute:"codebase",elements:"object"},{attribute:"codetype",elements:"object"},{attribute:"declare",elements:"object"},{attribute:"standby",elements:"object"},{attribute:"type",elements:"param"},{attribute:"valuetype",elements:"param"},{attribute:"language",elements:"script"},{attribute:"event",elements:"script"},{attribute:"for",elements:"script"},{attribute:"datapagesize",elements:"table"},{attribute:"summary",elements:"table"},{attribute:"axis",elements:"td; th"},{attribute:"scope",elements:"td"},{attribute:"datasrc",elements:"a; applet; button; div; frame; iframe; img; input; label; legend; marquee; object; option; select; span; table; textarea"},{attribute:"datafld",elements:"a; applet; button; div; fieldset; frame; iframe; img; input; label; legend; marquee; object; param; select; span; textarea"},{attribute:"dataformatas",elements:"button; div; input; label; legend; marquee; object; option; select; span; table"},{attribute:"alink",elements:"body"},{attribute:"bgcolor",elements:"body"},{attribute:"link",elements:"body"},{attribute:"marginbottom",elements:"body"},{attribute:"marginheight",elements:"body"},{attribute:"marginleft",elements:"body"},{attribute:"marginright",elements:"body"},{attribute:"margintop",elements:"body"},{attribute:"marginwidth",elements:"body"},{attribute:"text",elements:"body"},{attribute:"vlink",elements:"body"},{attribute:"clear",elements:"br"},{attribute:"align",elements:"caption"},{attribute:"align",elements:"col"},{attribute:"char",elements:"col"},{attribute:"charoff",elements:"col"},{attribute:"valign",elements:"col"},{attribute:"width",elements:"col"},{attribute:"align",elements:"div"},{attribute:"compact",elements:"dl"},{attribute:"align",elements:"embed"},{attribute:"hspace",elements:"embed"},{attribute:"vspace",elements:"embed"},{attribute:"align",elements:"hr"},{attribute:"color",elements:"hr"},{attribute:"noshade",elements:"hr"},{attribute:"size",elements:"hr"},{attribute:"width",elements:"hr"},{attribute:"align",elements:"h1; h2; h3; h4; h5; h6"},{attribute:"align",elements:"iframe"},{attribute:"allowtransparency",elements:"iframe"},{attribute:"frameborder",elements:"iframe"},{attribute:"hspace",elements:"iframe"},{attribute:"marginheight",elements:"iframe"},{attribute:"marginwidth",elements:"iframe"},{attribute:"scrolling",elements:"iframe"},{attribute:"vspace",elements:"iframe"},{attribute:"align",elements:"input"},{attribute:"hspace",elements:"input"},{attribute:"vspace",elements:"input"},{attribute:"align",elements:"img"},{attribute:"border",elements:"img"},{attribute:"hspace",elements:"img"},{attribute:"vspace",elements:"img"},{attribute:"align",elements:"legend"},{attribute:"type",elements:"li"},{attribute:"compact",elements:"menu"},{attribute:"align",elements:"object"},{attribute:"border",elements:"object"},{attribute:"hspace",elements:"object"},{attribute:"vspace",elements:"object"},{attribute:"compact",elements:"ol"},{attribute:"align",elements:"p"},{attribute:"width",elements:"pre"},{attribute:"align",elements:"table"},{attribute:"bgcolor",elements:"table"},{attribute:"cellpadding",elements:"table"},{attribute:"cellspacing",elements:"table"},{attribute:"frame",elements:"table"},{attribute:"rules",elements:"table"},{attribute:"width",elements:"table"},{attribute:"align",elements:"tbody; thead; tfoot"},{attribute:"char",elements:"tbody; thead; tfoot"},{attribute:"charoff",elements:"tbody; thead; tfoot"},{attribute:"valign",elements:"tbody; thead; tfoot"},{attribute:"align",elements:"td; th"},{attribute:"bgcolor",elements:"td; th"},{attribute:"char",elements:"td; th"},{attribute:"charoff",elements:"td; th"},{attribute:"height",elements:"td; th"},{attribute:"nowrap",elements:"td; th"},{attribute:"valign",elements:"td; th"},{attribute:"width",elements:"td; th"},{attribute:"align",elements:"tr"},{attribute:"bgcolor",elements:"tr"},{attribute:"char",elements:"tr"},{attribute:"charoff",elements:"tr"},{attribute:"valign",elements:"tr"},{attribute:"compact",elements:"ul"},{attribute:"type",elements:"ul"},{attribute:"background",elements:"body; table; thead; tbody; tfoot; tr; td; th"}],i=[{attributes:["alt"],element:"area"},{attributes:["height","width"],element:"applet"},{attributes:["dir"],element:"bdo"},{attributes:["action"],element:"form"},{attributes:["alt","src"],element:"img"},{attributes:["name"],element:"map"},{attributes:["label"],element:"optgroup"},{attributes:["name"],element:"param"},{attributes:["cols","rows"],element:"textarea"}],j=Object.keys(d).sort(),k={attributeWhitelist:[/ng\-[a-z\-]+/],elementWhitelist:[],isElementValid:function(a){return j.indexOf(a)>=0},isElementObsolete:function(a){return f.indexOf(a)>=0},isAttributeValidForElement:function(d,e){return b(d)||c(d)?!0:a(e).indexOf("any")>=0?!0:a(e).indexOf(d)>=0},isAttributeObsoleteForElement:function(a,b){return c(a)?!1:h.some(function(c){return c.attribute!==a?!1:c.elements.split(/\s*;\s*/).some(function(a){return a===b})})},isAttributeRequiredForElement:function(a,b){return i.some(function(c){return b==c.element&&c.attributes.indexOf(a)>=0})}};return k}()),j.addRule("bem-misused-elements",function(a,c){var d=this.modules.bem;a.on("class",function(a){d.isBlockElement(a)&&(b(this).parents().is("."+d.getBlockName(a))||c.addError("bem-misused-modifier","The BEM element '"+a+"' must be a descendent of '"+d.getBlockName(a)+"'.",this))})}),j.addRule("bem-misused-modifiers",function(a,c){var d=this.modules.bem;a.on("class",function(a){d.isBlockModifier(a)&&(b(this).is("."+d.getBlockName(a))||c.addError("bem-misused-modifiers","The BEM modifier class '"+a+"' was found without the block base class '"+d.getBlockName(a)+"'.",this))})}),j.addRule("duplicate-ids",function(a,b){var c=[];a.on("id",function(a){c.push({id:a,context:this})}),a.on("afterInspect",function(){for(var a,d,e=[];a=c.shift();)e=c.filter(function(b){return a.id===b.id}),c=c.filter(function(b){return a.id!==b.id}),e.length&&(d=[a.context].concat(e.map(function(a){return a.context})),b.addError("duplicate-ids","The id '"+a.id+"' appears more than once in the HTML.",d))})}),j.addRule("inline-event-handlers",function(a,b){a.on("attribute",function(a){0===a.indexOf("on")&&b.addError("inline-event-handlers","The '"+a+"' event handler was found inline in the HTML.",this)})}),j.addRule("misused-attributes",function(a,b){var c=j.modules.attributes.allowedAttributes;a.on("attribute",function(a){var d=this,e=d.nodeName.toLowerCase();c.forEach(function(c){a===c.attr&&c.elements.indexOf(e)<0&&b.addError("misused-attributes","The '"+a+"' attribute cannot be used on a <"+e+"> element.",d)})})}),j.addRule("nonsemantic-elements",function(a,b){a.on("element",function(a){var c="div"==a||"span"==a,d=0===this.attributes.length;c&&d&&b.addError("nonsemantic-elements","Do not use <div> or <span> elements without any attributes.",this)})}),j.addRule("obsolete-attributes",function(a,b){var c=j.modules.attributes.obsoluteAttributes;a.on("attribute",function(a){var d=this,e=d.nodeName.toLowerCase();c.forEach(function(c){c.attrs.indexOf(a)>-1&&c.elements.indexOf(e)>-1&&b.addError("obsolete-attributes","The '"+a+"' attribute of the <"+e+"> element is obsolete and should not be used.",d)})})}),j.addRule("obsolete-elements",function(a,b){var c=["basefont","big","center","font","strike","tt","frame","frameset","noframes","acronym","applet","isindex","dir"];a.on("element",function(a){c.indexOf(a)>=0&&b.addError("obsolete-elements","The <"+a+"> element is obsolete and should not be used.",this)})}),j.addRule("required-attributes",function(a,c){var d=j.modules.attributes.requiredAttributes;a.on("element",function(a){var e=this;d.forEach(function(d){var f;a===d.element&&(f=d.attrs.every(function(a){return null!=b(e).attr(a)}),f||c.addError("required-attributes","<"+a+"> elements must include the following attributes: '"+d.attrs.join("', '")+"'.",e))})})}),j.addRule("scoped-styles",function(a,c){a.on("element",function(a){var d,e;"style"==a&&(d=!b(this).closest("head").length,e=null!=b(this).attr("scoped"),d&&!e&&c.addError("scoped-styles","<style> elements outside of <head> must declare the 'scoped' attribute.",this))})}),j.addRule("unused-classes",function(a,b){var c=this.modules.css,d=c.whitelist,e=c.getClassSelectors();a.on("class",function(a){d.test(a)||-1!=e.indexOf(a)||b.addError("unused-classes","The class '"+a+"' is used in the HTML but not found in any stylesheet.",this)})}),j.addRule("validate-elements",function(a,b){var c=this.modules.validation;a.on("element",function(a){c.isElementValid(a)||b.addError("validate-elements","The <"+a+"> element is not a valid HTML element.",this)})}),window.HTMLInspector=j}(this,jQuery,document);